schema: '2.0'
stages:
  pull_data:
    cmd: mkdir -p data/raw && poetry run kaggle competitions download -c playground-series-s4e12
      && mv playground-series-s4e12.zip data/raw/ && cd data/raw/ && unzip playground-series-s4e12.zip
      && rm playground-series-s4e12.zip
    outs:
    - path: data/raw
      hash: md5
      md5: 81fcdcb7e37e0ac83770494236eb8c60.dir
      size: 332735146
      nfiles: 3
  prepare_basic:
    cmd: poetry run python insurance/prepare_basic.py
    deps:
    - path: insurance/prepare_basic.py
      hash: md5
      md5: acf606b1584cb3e843e2d50bdbdd7965
      size: 728
    params:
      params.yaml:
        data.random_state: 42
    outs:
    - path: data/prepared/prepared_data.csv
      hash: md5
      md5: be6d2a66bbfc1ca11856fe43b15f938d
      size: 164008012
  train_basic:
    cmd: poetry run python insurance/train_basic.py
    deps:
    - path: data/prepared/prepared_data.csv
      hash: md5
      md5: be6d2a66bbfc1ca11856fe43b15f938d
      size: 164008012
    - path: insurance/train_basic.py
      hash: md5
      md5: 1087798e3a88729a780248839e5d4271
      size: 4474
    outs:
    - path: out/models/model_basic.pkl
      hash: md5
      md5: 4b8a371d04e5278a135523ea5aa7dc66
      size: 145233
  train@basic:
    cmd: poetry run python insurance/train_basic.py
    deps:
    - path: data/prepared/prepared_data.csv
      hash: md5
      md5: be6d2a66bbfc1ca11856fe43b15f938d
      size: 164008012
    - path: insurance/data_pipeline.py
      hash: md5
      md5: 579c31a86a6a103ee6f051153665df74
      size: 2232
    - path: insurance/train_basic.py
      hash: md5
      md5: a06cbe504be513010151ff7bafe35db2
      size: 4542
    params:
      params.yaml:
        train.basic:
        train.n_splits: 5
        train.random_state: 42
    outs:
    - path: out/models/data_pipeline_basic.pkl
      hash: md5
      md5: 9b7521c0baf56fb6277312b2f948b187
      size: 33615
    - path: out/models/model_basic.pkl
      hash: md5
      md5: 9b7521c0baf56fb6277312b2f948b187
      size: 33615
  train@xgboost:
    cmd: poetry run python insurance/train_xgboost.py
    deps:
    - path: data/prepared/prepared_data.csv
      hash: md5
      md5: be6d2a66bbfc1ca11856fe43b15f938d
      size: 164008012
    - path: insurance/data_pipeline.py
      hash: md5
      md5: 907369258aee6cd37800ed36e3d7b141
      size: 2234
    - path: insurance/train_xgboost.py
      hash: md5
      md5: 7110d39b3fb3ace4a802303a79231c1e
      size: 3349
    params:
      params.yaml:
        train.n_splits: 5
        train.random_state: 42
        train.xgboost:
          random_state: 42
          device: cuda
          objective: reg:squarederror
          eval_metric: rmse
          booster: dart
          lambda: 1.196540467745646e-08
          alpha: 0.0025864232742840608
          subsample: 0.7451941308293244
          colsample_bytree: 0.903307259113048
          max_depth: 5
          min_child_weight: 10
          eta: 0.488889903860356
          gamma: 2.6789251648618205e-07
          grow_policy: lossguide
          sample_type: uniform
          normalize_type: tree
          rate_drop: 1.0241738602364063e-08
          skip_drop: 0.082417918876473
    outs:
    - path: out/models/data_pipeline_xgboost.pkl
      hash: md5
      md5: 85f03782b7a1df5c4d8039666ce60802
      size: 1119
    - path: out/models/model_xgboost.pkl
      hash: md5
      md5: 26693e18ae744facee3a8e385f5d8b1e
      size: 33641
